<div class="header bg-gradient-danger pb-8 pt-5 pt-md-8">
  <div class="container-fluid">
    <div class="header-body">
      <!-- Card stats -->
      <div class="row justify-content-center">
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0 border-0">
            <button
              class="btn btn-light"
              style="background-color: currentColor; border: none"
              (click)="OnClickMIOReports()"
              [ngStyle]="{ border: MIOBorder }"
            >
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <h5 class="card-title text-uppercase text-muted mb-0">
                      MIO Reports
                    </h5>
                    <!-- <span class="h2 font-weight-bold mb-0">350,897</span> -->
                  </div>
                </div>
              </div>
            </button>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0 border-0">
            <button
              class="btn btn-light"
              style="background-color: currentColor; border: none"
              type="button"
              (click)="OnClickCallExecuted()"
              [ngStyle]="{ border: CallsBorder }"
            >
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <h5 class="card-title text-uppercase text-muted mb-0">
                      Call Executed
                    </h5>
                    <!-- <span class="h2 font-weight-bold mb-0">350,897</span> -->
                  </div>
                </div>
              </div>
            </button>
          </div>
        </div>
        <div class="col-xl-3 col-lg-6">
          <div class="card card-stats mb-4 mb-xl-0 border-0">
            <button
              class="btn btn-light"
              style="background-color: currentColor; border: none"
              (click)="OnClickMSS()"
              [ngStyle]="{ border: MMSBorder }"
            >
              <div class="card-body">
                <div class="row">
                  <div class="col">
                    <h5 class="card-title text-uppercase text-muted mb-0">
                      Monthly Sales Summary
                    </h5>
                    <!-- <span class="h2 font-weight-bold mb-0">350,897</span> -->
                  </div>
                </div>
              </div>
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- Page content -->
<div class="container-fluid mt--7" *ngIf="IsMioReports">
  <!-- Table -->
  <div class="row">
    <div class="col">
      <h3 class="mb-0 text-center py-3 text-secondary">MIO Reports</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="card shadow">
        <div class="card-header border-0">
          <div class="row align-items-center">
            <!-- <div class="col-2">
              <h3 class="mb-0">MIO Reports</h3>
            </div> -->
            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                  (click)="DownloadMIOReports()"
                >
                  Download Report
                  <i class="ni ni-cloud-download-95 ml-1"></i>
                </button>
              </div>
            </div>
            <div class="col-2 text-center">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedCity }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllDistricts()"
                    >All Districts</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectKarachi()"
                    >Karachi</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectRawalpindi()"
                    >Rawalpindi</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectIslamabad()"
                    >Islamabad</a
                  >
                </div>
              </div>
            </div>

            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedType }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllTypes()"
                    >All</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectCHO()"
                    >CHO</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectMIO()"
                    >MIO</a
                  >
                </div>
              </div>
            </div>

            <div _ngcontent-crs-c122="" class="col-2">
              <button
                  type="button"
                  class="btn btn-secondary text-primary"
                  (click)="GetMIOReportsData()"
                >
                  Search
                </button>
            </div>

            <!-- <div class="col-2">
              <label for="from" class="mb-0">From:</label>
              <input
              type="date"
              id="from"
              name="from"
              class="rounded form-control"
              />
            </div>

            <div class="col-2">
              <label for="to" class="mb-0">To:</label>
              <input
                type="date"
                id="to"
                name="to"
                class="rounded form-control"
              />
            </div> -->

            <div class="col-2">
              <div class="form-group mb-0">
                <input
                  type="text"
                  class="form-control"
                  placeholder="Search..."
                  [(ngModel)]="filterProviderCode"
                />
              </div>
            </div>

          </div>
        </div>
        <div class="table-responsive">
          <table class="table align-items-center table-flush">
            <thead class="thead-light">
              <tr>
                <th scope="col">Index</th>
                <th scope="col">Date</th>
                <th scope="col">Provider Code</th>
                <th scope="col">Provider Name</th>
                <th scope="col">MIO</th>
                <th scope="col">District</th>
                <th scope="col">Category</th>
                <th scope="col">Pharmacy Code</th>
                <th scope="col">Tagged Pharmacy</th>
                <th scope="col">Monthly Sales</th>
              </tr>
            </thead>
            <tbody>
              <!-- Karachi -->
              <tr
                *ngFor="
                  let item of MIOReportsData | filter : filterProviderCode | paginate : { itemsPerPage: count, currentPage: p };
                  let i = index
                "
              >
                <td>{{ item.Index }}</td>
                <td>{{ item.Date }}</td>
                <td>{{ item.ProviderCode }}</td>
                <td>{{ item.ProviderName }}</td>
                <td>{{ item.MIO }}</td>
                <td>{{ item.District }}</td>
                <td>{{ item.Category }}</td>
                <td>{{ item.PharmacyCode }}</td>
                <td>{{ item.TaggedPharmacy }}</td>
                <td>{{ item.MonthlySales }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="card-footer py-4">
          <nav aria-label="...">
            <ul class="pagination justify-content-end mb-0">
              <pagination-controls
                class="my-pagination"
                (pageChange)="p = $event"
              >
              </pagination-controls>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- =========================== Call Executed ========================== -->
<div class="container-fluid mt--7" *ngIf="IsCallExecuted">
  <!-- Table -->
  <div class="row">
    <div class="col">
      <h3 class="mb-0 text-center py-3 text-secondary">Call Executed</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="card shadow">
        <div class="card-header border-0">
          <div class="row align-items-center">
            <!-- <div class="col-2"><h3 class="mb-0">Call Executed</h3></div> -->
            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                  (click)="DownloadCallExecutedReports()"
                >
                  Download Report
                  <i class="ni ni-cloud-download-95 ml-1"></i>
                </button>
              </div>
            </div>
            <div class="col-2 text-center">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedCity }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllDistricts()"
                    >All Districts</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectKarachi()"
                    >Karachi</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectRawalpindi()"
                    >Rawalpindi</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectIslamabad()"
                    >Islamabad</a
                  >
                </div>
              </div>
            </div>
            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedType }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllTypes()"
                    >All</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectCHO()"
                    >CHO</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectMIO()"
                    >MIO</a
                  >
                </div>
              </div>
            </div>
            <!-- <div class="col-2">
              <label for="from" class="mr-1">From:</label>
              <input
                type="date"
                id="from"
                name="from"
                class="rounded form-control"
              />
            </div>
            <div class="col-2">
              <label for="to" class="mr-1">To:</label>
              <input
                type="date"
                id="to"
                name="to"
                class="rounded form-control"
              />
            </div> -->
            <div _ngcontent-crs-c122="" class="col-2">
              <div _ngcontent-crs-c122="" class="form-group mb-0">
                <!-- <label
                  _ngcontent-crs-c122=""
                  for="input-username"
                  class="form-control-label"
                  >Select Year:
                </label> -->
                <input
                  _ngcontent-crs-c122=""
                  type="text"
                  class="form-control form-control-alternative"
                  placeholder="Enter Year"
                  (change)="SelectYear($event.target.value, i)"
                />
              </div>
            </div>
            <div _ngcontent-crs-c122="" class="col-2">
              <!-- <label
                _ngcontent-crs-c122=""
                for="input-username"
                class="form-control-label"
                >Select Month:
              </label> -->
              <div class="input-group">
                <select
                  class="custom-select"
                  id="inputGroupSelect01"
                  (change)="SelectMonth($event.target.value, i)"
                >
                  <option>Select Month</option>
                  <option value="January">January</option>
                  <option value="February">February</option>
                  <option value="March">March</option>
                  <option value="April">April</option>
                  <option value="May">May</option>
                  <option value="June">June</option>
                  <option value="July">July</option>
                  <option value="August">August</option>
                  <option value="September">September</option>
                  <option value="October">October</option>
                  <option value="November">November</option>
                  <option value="December">December</option>
                </select>
              </div>
            </div>
            <div _ngcontent-crs-c122="" class="col-2">
              <button
                  type="button"
                  class="btn btn-secondary text-primary"
                  (click)="GetBusinessAPIData(year, monthId)"
                >
                  Search
                </button>
            </div>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table align-items-center table-flush">
            <thead class="thead-light">
              <tr class="text-center">
                <th colspan="4" class="bg-lighter">
                  Monthly Calls-till 31st January 2023 (Wk-46 to 50)
                </th>
                <th colspan="8" class="bg-light">Planned vs Unplanned</th>
                <th colspan="5" class="bg-lighter">In vs Out Range</th>
              </tr>
              <tr>
                <th scope="col">Index</th>
                <th scope="col">District</th>
                <th scope="col">Month</th>
                <th scope="col">Name</th>
                <th scope="col">Calls Planned</th>
                <th scope="col">Planned</th>
                <th scope="col">Unplanned</th>
                <th scope="col">Actual Visited</th>
                <th scope="col">Not Visited</th>
                <th scope="col">% Planned</th>
                <th scope="col">% Unplanned</th>
                <th scope="col">% Total</th>
                <th scope="col">In Range</th>
                <th scope="col">Out Range</th>
                <th scope="col">Grand Total</th>
                <th scope="col">% In Range</th>
                <th scope="col">% Out Range</th>
              </tr>
            </thead>
            <tbody
              *ngFor="
                let data of CallsExecutedData
                | paginate : { itemsPerPage: count, currentPage: p };
                let i = index
              "
            >
              <!-- <tr *ngIf="KarachiSelected"> -->
              <tr>
                <td>{{ i + 1 }}</td>
                <td>{{ data.District }}</td>
                <td>{{ data.Month }}</td>
                <td>{{ data.Name }}</td>
                <td>{{ data.CallsPlanned }}</td>
                <td>{{ data.Planned }}</td>
                <td>{{ data.CallsUnplanned }}</td>
                <td>{{ data.ActuallyVisited }}</td>
                <td>{{ data.NotVisited }}</td>
                <td>{{ data.PlannedPercentage }}</td>
                <td>{{ data.UnplannedPercentage }}</td>
                <td>----</td>
                <td>{{ data.InRange }}</td>
                <td>{{ data.OutRange }}</td>
                <td>{{ data.GrandTotal }}</td>
                <td>{{ data.InRangePercent }}</td>
                <td>{{ data.OutRangePercent }}</td>
                <!-- </tr>
              <tr *ngIf="RawalpindiSelected"> -->
                <!-- <td>Rawalpindi</td>
                <td>Jan-23</td>
                <td>Akhtar (RWP-MIO-01)</td>
                <td>181</td>
                <td>161</td>
                <td>5</td>
                <td>166</td>
                <td>15</td>
                <td>89%</td>
                <td>3%</td>
                <td>92%</td>
                <td>144</td>
                <td>22</td>
                <td>166</td>
                <td>87%</td>
                <td>13%</td> -->
              </tr>
            </tbody>
          </table>

          <!-- <div style="display: flex; justify-content: center">
            <pagination-controls
              class="my-pagination"
              (pageChange)="p = $event"
            ></pagination-controls>
          </div> -->
        </div>
        <div class="card-footer py-4">
          <nav aria-label="...">
            <ul class="pagination justify-content-end mb-0">
              <pagination-controls
                class="my-pagination"
                (pageChange)="p = $event"
              >
              </pagination-controls>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
<!-- =================================== Monthly Sales Summary ============================== -->
<div class="container-fluid mt--7" *ngIf="IsMSS">
  <!-- Table -->
  <div class="row">
    <div class="col">
      <h3 class="mb-0 text-center py-3 text-secondary">MIO - M&P Monthly Sales</h3>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <div class="card shadow">
        <div class="card-header border-0">
          <div class="row align-items-center">
            <!-- <div class="col-3">
              <h3 class="mb-0">MIO - M&P Monthly Sales</h3>
            </div> -->
            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                  (click)="DownloadMonthlySalesReports()"
                >
                  Download Report
                  <i class="ni ni-cloud-download-95 ml-1"></i>
                </button>
              </div>
            </div>
            <div class="col-2 text-center">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedCity }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllDistricts()"
                    >All Districts</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectKarachi()"
                    >Karachi</a
                  >
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectIslamabad()"
                    >Islamabad</a
                  >
                </div>
              </div>
            </div>
            <div class="col-2">
              <div ngbDropdown class="btn-group dropdown">
                <button
                  type="button"
                  ngbDropdownToggle
                  class="btn btn-secondary dropdown-toggle"
                  data-toggle="dropdown"
                  aria-haspopup="true"
                  aria-expanded="false"
                >
                  {{ SelectedType }} <i class="ni ni-bold-down"></i>
                </button>
                <div ngbDropdownMenu class="dropdown-menu">
                  <a
                    ngbDropdownItem
                    class="dropdown-item"
                    (click)="SelectAllTypes()"
                    >All</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectCHO()"
                    >CHO</a
                  >
                  <a ngbDropdownItem class="dropdown-item" (click)="SelectMIO()"
                    >MIO</a
                  >
                </div>
              </div>
            </div>
            <!-- <div class="col-1 text-right">
              <label for="from" class="mr--3 mb-0">From:</label>
            </div> -->
            <div class="col-2">
              <label for="from" class="mb-0">From:</label>
              <input
              type="date"
              id="from"
              name="from"
              class="rounded form-control"
              (change)="SelectStartingDate($event.target.value, i)"
              />
            </div>
            <!-- <div class="col-1">
              <label for="to" class="mb-0">To:</label>
            </div> -->
            <div class="col-2">
              <label for="to" class="mb-0">To:</label>
              <input
              type="date"
              id="to"
              name="to"
              class="rounded form-control"
              (change)="SelectEndingDate($event.target.value, i)"
              />
            </div>
            <div _ngcontent-crs-c122="" class="col-2">
              <button
                  type="button"
                  class="btn btn-secondary text-primary"
                  (click)="GetSalesSummaryData()"
                >
                  Search
                </button>
            </div>
          </div>
        </div>
        <div class="table-responsive">
          <table class="table align-items-center table-flush">
            <thead class="thead-light">
              <tr>
                <th scope="col">Index</th>
                <th scope="col">Position Code</th>
                <th scope="col">Employee Name</th>
                <th scope="col">Number Of Doctors</th>
                <th scope="col">No of Providers Active</th>
                <th scope="col">Active %</th>
                <th scope="col">Jan-23 - Sales</th>
              </tr>
            </thead>
            <tbody>
              <!-- <tr *ngIf="KarachiSelected"> -->
              <tr *ngFor="let data of SalesSummaryData; let i = index">
                <td>{{i + 1}}</td>
                <td>{{data.PositionCode}}</td>
                <td>{{data.EmployeeName}}</td>
                <td>{{data.NumberOfDoctors}}</td>
                <td>{{data.NumberOfProvidersActive}}</td>
                <td>{{data.ActivePercentage}}</td>
                <td>{{data.MonthSales}}</td>
              </tr>
              <!-- <tr *ngIf="KarachiSelected">
                <td>KHI01-HYST-MIO-02</td>
                <td>Noman</td>
                <td>60</td>
                <td>20</td>
                <td>33%</td>
                <td>730</td>
              </tr>
              <tr *ngIf="AllDistrictsSelected">
                <td>ISB01-HYST-MIO-01</td>
                <td>Akhter</td>
                <td>60</td>
                <td>16</td>
                <td>27%</td>
                <td>70</td>
              </tr>
              <tr *ngIf="AllDistrictsSelected">
                <td>ISB01-HYST-MIO-02</td>
                <td>Shazia</td>
                <td>60</td>
                <td>16</td>
                <td>27%</td>
                <td>70</td>
              </tr> -->
            </tbody>
          </table>
        </div>
        <div class="card-footer py-4">
          <nav aria-label="...">
            <ul class="pagination justify-content-end mb-0">
              <li class="page-item disabled">
                <a class="page-link" href="javascript:void(0)" tabindex="-1">
                  <i class="fas fa-angle-left"></i>
                  <span class="sr-only">Previous</span>
                </a>
              </li>
              <li class="page-item active">
                <a class="page-link" href="javascript:void(0)">1</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="javascript:void(0)"
                  >2 <span class="sr-only">(current)</span></a
                >
              </li>
              <li class="page-item">
                <a class="page-link" href="javascript:void(0)">3</a>
              </li>
              <li class="page-item">
                <a class="page-link" href="javascript:void(0)">
                  <i class="fas fa-angle-right"></i>
                  <span class="sr-only">Next</span>
                </a>
              </li>
            </ul>
          </nav>
        </div>
      </div>
    </div>
  </div>
</div>
